INTSourceChangelist:2670989
Availability:Public
Title:ステートマシーンの作成
Crumbs: %ROOT%, Engine, Engine/Animation, Engine/Animation/StateMachines
Description:Vim アニメーション アセットの AnimGraph に使用するステートマシーンの新規作成ガイド
version: 4.9

[TOC(start:2)]



実際に **ステートマシーン** を作成する前に、ステート間の遷移を操作する状況に加えて、本当に必要なステートについてじっくり計画すると良いでしょう。そうすることで、ステートマシンのみならず、ステートマシーンを操作するための変数や各ステートに組み込みアニメーションについて、周到な計画を立てることができます。

ステートマシーンの作成は Animation ブループリントの AnimGraph 内で行われます。AnimGrpah 内で **右クリック** し、コンテキスト メニューから **[State Machines] > [New State Machine]** を選ぶだけです。

![](CreateNewStateMachine.png)

一般的に、ステートマシーンを作成したらすぐに名前を付けた方が良いです。**[My Blueprint]** ウィンドウで作成したステートマシーンを **右クリック** し、名前の入力フィールドに新しい名前を入力します。この例では、ステートマシーンに「Locomotion」という名前が付けられています。

![](RenameStateMachine.png)

![](LocomotionSMNode.png)

作成された時点では、ステートマシーンはブランクです。ステートマシーンを開き、 **ダブルクリック** してステートと遷移を定義します。すると新規グラフのタブが開きます。このグラフはエントリー ポイントのみで始まり、それが基本的にアニメーションを開始します。


![](StateMachineEntryPoint.png)

## ステートとコンジットの作成

ステートは、ブループリント内で新規ノードを作成する方法で作成します。**右クリック** してコンテンツ メニューから 1 つを作成するか、グラフの空いている部分にワイヤをドラッグしマウスをリリースしてもコンテンツ メニューが開きます。

![](AddState_CM.png)

![](AddStateDragWire.png)

新規作成されたステートにはすぐに名前を付けてください。名前の付け方は、作成されたステート名をすぐクリックするか、グラフ内または **[My Blueprint]** パネル内のノードをクリックします。

![](StateDefault.png)

![](StateRenamed.png)

コンジットも同じく、グラフ内を **右クリック** するか、新規ワイヤをグラフ内の空のスペースにドラッグして作成します。

![](CreateConduit.png)



## 遷移ルールの作成

**遷移ルール** は、ステートとコンジットを接続するワイヤーと一緒に自動的に作成されます。遷移ルールは、小さくて丸い方向を示すアイコンで表示されます。

![](NewTransitionRule.png)

つまり、グラフの空いている部分にワイヤをドラッグしてステートあるいはコンジットを新規作成した場合、遷移ルールはそのワイヤに対して自動的に作成されます。さらに、ワイヤを元のノードにドラッグすれば、そのノードへの遷移に対して 2 つ目の遷移ルールを作成することができます。

![](CreateTransition.png)


